{% extends 'base.html'%}

{% block head %}
<link href={{ url_for('static', filename = 'main1.css') }} rel="stylesheet" type="text/css" media="all">
{% endblock %}

{% block body %}
<ul>
    <li><a class="active" href="/">Home</a></li>
    <li><a href="/left/">Left-Wing</a></li>
    <li><a href="/center/">Center</a></li>
    <li><a href="/right/">Right-Wing</a></li>
    <li><a href="/international/">International</a></li>
  </ul>
  <div id="myNav" class="overlay">
    <div class="overlay-content">
    </div>
  </div>
<div class = "content">
    <h1 style="text-align: center">Trending Stories</h1>
    <div class="row">
      {% for story in stories %}
      <div class="column">
         <div class="card">
          <h3><center><strong>{{ story.source_name }}</strong></center></h3>
          <div class="div1" onclick="logEvent('click', '{{ story.url }}');"><a href="{{ story.url }}" target="_blank"><figure><center><img style="width:100%" src= {{ story.image_url }}></figure></center><figcaption><b>{{ story.title }}</b></figcaption></a></div>
          <p style="font-size: 12px;"><i>{{ story.description }}</i><p>
        </div>
      </div>
      {% endfor %}
    </div>
    <div id = "notification" class ="cookie-banner-container">
      <p align="right">
        <input type="button" value="X" onclick="enableScroll(), myFunction(), logEvent('click', 'button_x');"/>
      </p>      
      <center>
      <p id="text" style="font-size:12px;">
        California residents have certain rights with regard to the sale of personal information to third parties. We use information collected through cookies or in other forms to improve experience on our site and pages, analyze how it is used and show personalized advertising.  At any point, you can opt out of the sale of all of your personal information by pressing “Do not sell my personal information”  You can find out more in our privacy policy at the bottom of any page.
      </p>
      <button type="button" onclick="enableScroll(), myFunction(), logEvent('click', 'button1_accept_cookies');">
        Accept cookies
      </button>
      <button type="button" id="button2" onclick="myFunction()">
        Do not sell my information
      </button>
      </center>
    </div>

    <script>

    // Declare global variables for banner style
    
    //Code to determine based on hash of user IP address
    /*var left_right = {{ left_right }} ;
    var up_down = {{ up_down }} ;
    var versions = {{ versions }} ;
    if (window.innerwidth <500){
        left_right=1;
        var mobile=true;
      }
    else{
      var mobile=false;
    }
    var banner_style = String(left_right) + String(up_down) + String(versions);
    */

    /* Code for random determination of privacy banner
      var left_right = Math.floor(Math.random() * 3);
      var up_down= Math.floor(Math.random() * 2);
      var versions=Math.floor(Math.random()*2)
    */

      function disableScroll() { 
    // Get the current page scroll position 
    scrollTop = window.pageYOffset || document.documentElement.scrollTop; 
    scrollLeft = window.pageXOffset || document.documentElement.scrollLeft, 
  
        // if any scroll is attempted, set this to the previous value 
        window.onscroll = function() { 
            window.scrollTo(scrollLeft, scrollTop); 
        }; 
} 
  
function enableScroll() { 
    window.onscroll = function() {}; 
} 

function determine_layout() {

      /*var x = document.getElementById("notification");
      var body=document.getElementById("body");
      var button2 = document.getElementById("button2");
      var screenWidth=window.innerWidth;
      var screenHeight=String(window.innerHeight -340)+"px";
      if (String(left_right) == "0"){
        x.style.left = "10px";
        x.style.right="";
      }
      else if (String(left_right) == "1"){
        x.style.left = "24px";
        x.style.right="24px"
      }
      else if (String(left_right) == "2"){
        x.style.left = "";
        x.style.right="10px"
      }
      if (String(up_down) == "0"){
        x.style.bottom=screenHeight;
      }
      else if (String(up_down) =="1"){
        x.style.bottom="10px";
      }
      if (String(versions) == "0"){
        button2.innerHTML="Read our cookie policy"
        button2.setAttribute( "onClick", "javascript: readMore(), logEvent('click', 'button2_read_more');" )
      }
      else{
        button2.innerHTML="Do not sell my information"
        button2.setAttribute( "onClick", "javascript: myFunction(), enableScroll(), logEvent('click', 'button2_do_not_sell');" )
      }*/
      var desktop_layout=Math.floor(Math.random() * 8);
      var mobile_layout=Math.floor(Math.random()*4);
      var x = document.getElementById("notification");
      var overlay=document.getElementById("myNav");
      var button2 = document.getElementById("button2");
      var screenWidthString=String(window.innerWidth+100)+"px";
      var screenHeight=String(window.innerHeight -340)+"px";
      var bannerScreenHeight=String(window.innerHeight-200)+"px";
      var middleScreenHeight=String((window.innerHeight)/3)+"px";
      x.style.display="block";
      if (window.innerWidth>500){
      if (String(desktop_layout) == "0"){
        x.style.bottom="10px";
        x.style.left = "10px";
        x.style.right="";
      }
      if (String(desktop_layout) == "1"){
        x.style.bottom="10px";
        x.style.left = "24px";
        x.style.right="24px";
        x.style.maxWidth=screenWidthString;
      }
      if (String(desktop_layout) == "2"){
        x.style.bottom="10px";
        x.style.left = "";
        x.style.right="10px"
      }
      if (String(desktop_layout) == "3"){
        x.style.bottom=screenHeight;
        x.style.left = "10px";
        x.style.right="";
      }
      if (String(desktop_layout) == "4"){
        x.style.bottom=bannerScreenHeight;
        x.style.left = "24px";
        x.style.right="24px";
        x.style.maxWidth=screenWidthString;
      }
      if (String(desktop_layout) == "5"){
        x.style.bottom=screenHeight;
        x.style.left = "";
        x.style.right="10px"
      }
      if (String(desktop_layout) == "6"){
        x.style.bottom=middleScreenHeight;
        x.style.left = "24px";
        x.style.right="24px";
      }
      if (String(desktop_layout)=="7"){
        x.style.display="none";
      }
    }
    ///check for mobile
    else{
      x.style.left = "24px";
      x.style.right="24px";
      if (String(mobile_layout)=="0"){
        x.style.bottom="10px"
      }
      if (String(mobile_layout)=="1"){
        x.style.bottom=middleScreenHeight;
      }
      if (String(mobile_layout)=="2"){
        x.style.bottom=screenHeight;
      }
      if (String(mobile_layout)=="3"){
        x.style.display="none";
      }
    }}
    function linkClicked(){
      var x = document.getElementById("notification");
      var middleScreenHeight=String((window.innerHeight)/3)+"px"
      x.style.display="block";
      x.style.bottom=middleScreenHeight;
      x.style.left = "24px";
      x.style.right="24px";
    }

    function endOverlay(){
      var overlay=document.getElementById("myNav");
      overlay.style.display="none"
    }
    function readMore(){
      var button2 = document.getElementById("button2");
      var text = document.getElementById("text");
      text.innerHTML="Under the California Consumer Privacy Act, you have the right to opt-out of the sale of your personal information to third parties. You may exercise your right to opt out of the sale of personal information by clicking the 'Deny Cookies' button.";
      button2.innerHTML="Don't allow";
      button2.setAttribute( "onClick", "javascript: myFunction(), enableScroll(), endOverlay();" )
    }
      function myFunction() {
      var x = document.getElementById("notification");
      if (x.style.display === "none") {
        x.style.display = "block";
      } 
      else {
        x.style.display = "none";
      }
      }
    </script>
</div>
<div class="footer">
  <p><a href="https://www.freeprivacypolicy.com/blog/privacy-policy-url/" target="_blank">Privacy Policy</a> &nbsp; &nbsp;&nbsp; <a class="policy" onclick="linkClicked()">Do Not Sell My Information</a></p>
{% endblock %}